From 1651eaf16902a65aaaab0145f91c6b88c4e17c56 Mon Sep 17 00:00:00 2001
From: Maarten Lankhorst <m.b.lankhorst@gmail.com>
Date: Sat, 31 Aug 2013 08:36:01 +0200
Subject: [PATCH 17/41] winepulse v12

Changes since v11:
- Fix incorrect assertions which may fail on moving a capture device
- Whitespace apply fixes

Changes since v10:
- Make some members static
- Fix small memory leak in GetService
---
 dlls/winepulse.drv/mmdevdrv.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

Index: wine1.6-1.7.1-actually1.6/dlls/winepulse.drv/mmdevdrv.c
===================================================================
--- wine1.6-1.7.1-actually1.6.orig/dlls/winepulse.drv/mmdevdrv.c	2013-09-13 16:19:09.000000000 -0700
+++ wine1.6-1.7.1-actually1.6/dlls/winepulse.drv/mmdevdrv.c	2013-09-13 16:19:56.000000000 -0700
@@ -596,10 +596,11 @@
         dst = p->data;
         while (rem) {
             pa_stream_peek(This->stream, (const void**)&src, &src_len);
-            assert(src_len && src_len <= bytes);
+            assert(src_len);
             assert(This->peek_ofs < src_len);
             src += This->peek_ofs;
             src_len -= This->peek_ofs;
+            assert(src_len <= bytes);
 
             copy = rem;
             if (copy > src_len)
@@ -627,9 +628,10 @@
         while (rem) {
             const void *src;
             pa_stream_peek(This->stream, &src, &src_len);
-            assert(src_len && src_len <= bytes);
+            assert(src_len);
             assert(This->peek_ofs < src_len);
             src_len -= This->peek_ofs;
+            assert(src_len <= bytes);
 
             copy = rem;
             if (copy > src_len)
