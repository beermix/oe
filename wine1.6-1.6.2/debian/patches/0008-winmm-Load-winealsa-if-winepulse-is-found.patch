From bea77093864177659aa16aab5d81b213015990b9 Mon Sep 17 00:00:00 2001
From: Maarten Lankhorst <maarten.lankhorst@canonical.com>
Date: Sat, 31 Aug 2013 08:36:00 +0200
Subject: [PATCH 08/41] winmm: Load winealsa if winepulse is found

Fixes midi on winepulse
---
 dlls/winmm/lolvldrv.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

Index: wine1.6-1.7.1-actually1.6/dlls/winmm/lolvldrv.c
===================================================================
--- wine1.6-1.7.1-actually1.6.orig/dlls/winmm/lolvldrv.c	2013-09-13 16:19:05.000000000 -0700
+++ wine1.6-1.7.1-actually1.6/dlls/winmm/lolvldrv.c	2013-09-13 16:19:09.000000000 -0700
@@ -543,7 +543,10 @@
     drvA = HeapAlloc(GetProcessHeap(), 0, size);
     WideCharToMultiByte(CP_ACP, 0, pv.u.pwszVal, -1, drvA, size, NULL, NULL);
 
-    MMDRV_Install(drvA, drvA, FALSE);
+    if (!strcasecmp(drvA, "winepulse.drv"))
+        MMDRV_Install("winealsa.drv", "winealsa.drv", 0);
+    else
+        MMDRV_Install(drvA, drvA, FALSE);
 
     HeapFree(GetProcessHeap(), 0, drvA);
     PropVariantClear(&pv);
