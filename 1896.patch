From 4f1bf02dc6895ba6a188c2a78697acc73f8efc20 Mon Sep 17 00:00:00 2001
From: MilhouseVH <milhouseVH.github@nmacleod.com>
Date: Tue, 15 Aug 2017 23:09:58 +0100
Subject: [PATCH] config/functions: fix bash-4.4 issue, and possible
 undesirable behaviour with empty 2nd param

---
 config/functions | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/config/functions b/config/functions
index b43f439a140..e63764f6995 100644
--- a/config/functions
+++ b/config/functions
@@ -529,7 +529,7 @@ print_color() {
   local clr_name="$1" clr_text="$2" clr_actual
 
   if [ "$DISABLE_COLORS" == "yes" ]; then
-    [ -n "${clr_text}" ] && echo -en "${clr_text}"
+    [ $# -eq 2 ] && echo -en "${clr_text}"
     return 0
   fi
 
@@ -541,9 +541,9 @@ print_color() {
   # Otherwise if $clr_name isn't defined, or doesn't exist, then use
   # standard colours.
   #
-  if [ -n "${clr_actual}" -a -z "${!clr_actual}" ]; then
+  if [[ -n "${clr_actual}" ]] && [[ -z "${!clr_actual}" ]]; then
     clr_actual="${clr_name}"
-  elif [ -z "${clr_actual}" -o -z "${!clr_actual}" ]; then
+  elif [[ -z "${clr_actual}" ]] || [[ -z "${!clr_actual}" ]]; then
     case "${clr_name}" in
       CLR_ERROR)        clr_actual="boldred";;
       CLR_WARNING)      clr_actual="boldred";;
@@ -567,7 +567,7 @@ print_color() {
     esac
   fi
 
-  if [ -n "${clr_text}" ]; then
+  if [ $# -eq 2 ]; then
     echo -en "${!clr_actual}${clr_text}${endcolor}"
   else
     echo -en "${!clr_actual}"
