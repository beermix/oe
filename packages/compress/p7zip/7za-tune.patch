diff -Naur p7zip-16.02-orig/CPP/7zip/CMAKE/7za/CMakeLists.txt p7zip-16.02/CPP/7zip/CMAKE/7za/CMakeLists.txt
--- p7zip-16.02-orig/CPP/7zip/CMAKE/7za/CMakeLists.txt	2018-04-27 03:59:20.131831991 +0300
+++ p7zip-16.02/CPP/7zip/CMAKE/7za/CMakeLists.txt	2016-03-10 10:27:16.000000000 +0300
@@ -1,4 +1,19 @@
+IF(HAVE_WCHAR_H)
+  OPTION(HAVE_UNICODE_WCHAR "Enable Unicode Support" YES)
+  MARK_AS_ADVANCED(HAVE_UNICODE_WCHAR)
+ELSE(HAVE_WCHAR_H)
+  SET(HAVE_UNICODE_WCHAR 0)
+ENDIF(HAVE_WCHAR_H)
 
+SET(HAVE_PTHREADS 0)
+FIND_PACKAGE(Threads)
+IF(WIN32 OR CMAKE_USE_PTHREADS_INIT)
+  SET(HAVE_PTHREADS 1)
+ENDIF(WIN32 OR CMAKE_USE_PTHREADS_INIT)
+
+add_definitions(-DENV_HAVE_GCCVISIBILITYPATCH)
+
+SET(CMAKE_CXX_FLAGS "-fvisibility=hidden -fvisibility-inlines-hidden")
 
 # WARNING : automatically generated by utils/generate.py
 cmake_minimum_required(VERSION 2.8)
