Description: Arrange font actions
Origin: upstream, http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/rev/ce5c56e0676f
Bug: (no upstream bug yet)

--- icu-4.8.1.1.orig/source/layout/IndicRearrangementProcessor.cpp
+++ icu-4.8.1.1/source/layout/IndicRearrangementProcessor.cpp
@@ -51,11 +51,11 @@
     }
 
     if (flags & irfMarkFirst) {
-        firstGlyph = (le_uint32)currGlyph;
+        firstGlyph = currGlyph;
     }
 
     if (flags & irfMarkLast) {
-        lastGlyph = (le_uint32)currGlyph;
+        lastGlyph = currGlyph;
     }
 
     doRearrangementAction(glyphStorage, (IndicRearrangementVerb) (flags & irfVerbMask), success);
@@ -93,7 +93,7 @@
         if (firstGlyph == lastGlyph) break;
         if (firstGlyph + 1 < firstGlyph) {
             success = LE_INDEX_OUT_OF_BOUNDS_ERROR;
-        break;
+            break;
         }
         a = glyphStorage[firstGlyph];
         ia = glyphStorage.getCharIndex(firstGlyph, success);
--- icu-4.8.1.1.orig/source/layout/IndicRearrangementProcessor.h
+++ icu-4.8.1.1/source/layout/IndicRearrangementProcessor.h
@@ -51,8 +51,8 @@
     static UClassID getStaticClassID();
 
 protected:
-    le_uint32 firstGlyph;
-    le_uint32 lastGlyph;
+    le_int32 firstGlyph;
+    le_int32 lastGlyph;
 
     LEReferenceTo<IndicRearrangementSubtableHeader> indicRearrangementSubtableHeader;
     LEReferenceToArrayOf<IndicRearrangementStateEntry> entryTable;
--- icu-4.8.1.1.orig/source/layout/IndicRearrangementProcessor2.cpp
+++ icu-4.8.1.1/source/layout/IndicRearrangementProcessor2.cpp
@@ -49,11 +49,11 @@
     }
 
     if (flags & irfMarkFirst) {
-        firstGlyph = (le_uint32)currGlyph;
+        firstGlyph = currGlyph;
     }
 
     if (flags & irfMarkLast) {
-        lastGlyph = (le_uint32)currGlyph;
+        lastGlyph = currGlyph;
     }
 
     doRearrangementAction(glyphStorage, (IndicRearrangementVerb) (flags & irfVerbMask), success);
@@ -90,7 +90,7 @@
         if (firstGlyph == lastGlyph) break;
         if (firstGlyph + 1 < firstGlyph) {
             success = LE_INDEX_OUT_OF_BOUNDS_ERROR;
-        break;
+            break;
         }
         a = glyphStorage[firstGlyph];
         ia = glyphStorage.getCharIndex(firstGlyph, success);
--- icu-4.8.1.1.orig/source/layout/IndicRearrangementProcessor2.h
+++ icu-4.8.1.1/source/layout/IndicRearrangementProcessor2.h
@@ -51,8 +51,8 @@
     static UClassID getStaticClassID();
 
 protected:
-    le_uint32 firstGlyph;
-    le_uint32 lastGlyph;
+    le_int32 firstGlyph;
+    le_int32 lastGlyph;
 
     LEReferenceToArrayOf<IndicRearrangementStateEntry2> entryTable;
     LEReferenceTo<IndicRearrangementSubtableHeader2> indicRearrangementSubtableHeader;
--- icu-4.8.1.1.orig/source/runConfigureICU
+++ icu-4.8.1.1/source/runConfigureICU
@@ -380,7 +380,7 @@
     then
         case $CC in
             gcc|*/gcc|*-gcc-*|*/*-gcc-*)
-                RELEASE_CFLAGS=-O3
+                RELEASE_CFLAGS=-O3 -fno-strict-overflow
                 ;;
         esac
     fi
@@ -392,7 +392,7 @@
     then
         case $CXX in
             g++|*/g++|*-g++-*|*/*-g++-*)
-                RELEASE_CXXFLAGS=-O3
+                RELEASE_CXXFLAGS=-O3 -fno-strict-overflow
                 ;;
         esac
     fi
