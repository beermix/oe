From 302f8c5bab4f343ce8ce764954058de2cdf4f540 Mon Sep 17 00:00:00 2001
From: Con Kolivas <kernel@kolivas.org>
Date: Fri, 26 May 2017 15:51:43 +1000
Subject: [PATCH 19/24] Fix UP build for muqss-155

---
 kernel/sched/MuQSS.h |   10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

Index: linux-4.11-ck2/kernel/sched/MuQSS.h
===================================================================
--- linux-4.11-ck2.orig/kernel/sched/MuQSS.h	2017-05-26 19:04:59.644228149 +1000
+++ linux-4.11-ck2/kernel/sched/MuQSS.h	2017-05-26 19:04:59.644228149 +1000
@@ -336,6 +336,8 @@ extern struct static_key_false sched_sch
 	rcu_dereference_check((p), \
 			      lockdep_is_held(&sched_domains_mutex))
 
+#ifdef CONFIG_SMP
+
 /*
  * The domain tree (rq->sd) is protected by RCU's quiescent state transition.
  * See detach_destroy_domains: synchronize_sched for details.
@@ -458,7 +460,6 @@ static inline void unregister_sched_doma
 }
 #endif
 
-#ifdef CONFIG_SMP
 extern void sched_ttwu_pending(void);
 extern void set_cpus_allowed_common(struct task_struct *p, const struct cpumask *new_mask);
 extern void set_rq_online (struct rq *rq);
@@ -474,9 +475,12 @@ static inline void trigger_load_balance(
 }
 
 #define sched_feat(x) 0
-#else
+
+#else /* CONFIG_SMP */
+
 static inline void sched_ttwu_pending(void) { }
-#endif
+
+#endif /* CONFIG_SMP */
 
 #ifdef CONFIG_CPU_IDLE
 static inline void idle_set_state(struct rq *rq,
